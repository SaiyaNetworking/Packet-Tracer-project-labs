
4.8 Configure network devices for remote access using SSH


Setting up remote SSH lines requires a few prerequisites before you can SSH into a system:
	1) You need a local account (preferably with a password...!)
	2) You need a domain-name (you don't need a server for DNS, but the system needs a domain-name tied to it.)
	3) You need an interface to access (direct interface, loopback interface, or a management interface)
	4) You need to configure the virtual console lines (the exam objective says remote access, not through the local line)

For our current lab, the domain-name (CISCO.com) and the management interface (10.0.1.240-243) have already been configured. Your job in this lab is to set up the local accounts and then the login method for the first three virtual console lines.


Step 1:
First, we need to verify we can connect to the access interfaces under the Administration VLAN using the Admin PC.

	PC1: Ping 10.0.1.240			//SW1
	PC1: Ping 10.0.1.241			//SW2
	PC1: Ping 10.0.1.242			//SW3
	PC1: Ping 10.0.1.243			//SW4


Step 2:
Now we need to create a local user account on each switch using the highest privilege level and the best encryption available. Standard privilege levels are either 0 for read-only or 15 for complete access. 1-14 can be configured but that is outside of the scope of the CCNA. The MLS will also be able to use the algorithm-type scrypt encryption but the access switches will only be able to use the secret encryption. The commands will look like this:
	Switches(config)#username [name] privilege [0-15] secret [password]
	MLS(config)#username [name] privilege [0-15] algorithm-type scrypt secret [password]

	SW1-4(config)#username admin privilege 15 secret cisco
	MLS(config)#username admin privilege 15 algorithm-type scrypt secret cisco


Step 3:
To generate crypto keys, you need a domain-name (which is already configured) and then you can input the command:
	(config)#crypto key generate rsa
		Then you will input a minimum or maximum of the key modulus [360-4096]


	MLS,SW1-4(config)#crypto key generate rsa
	The name for the keys will be: SW1.CISCO.com
		Choose the size of the key modulus in the range of 360 to 4096 for your
		  General Purpose Keys. Choosing a key modulus greater than 512 may take
		  a few minutes.

		How many bits in the modulus [512]: 2048					//user input of the requested 2048
		% Generating 2048 bit RSA keys, keys will be non-exportable...[OK]

	MLS,SW1-4(config)#ip ssh version 2						//version 2 is the most recent version


Step 4:
Now we need to set up remote access. There are two ways to log into the Cisco devices. The first is a console or local line (as if you were directly wired into the device itself.) The other is through IP services like Telnet or SSH. First, we need to access the virtual lines themselves. The command is:
	(config)#line vty [0-15 low] [1-15 high]

	MLS,SW1-4(config)#line vty 0 3					//access the virtual consoles 0-3

Now we need to:
	Bind the local account to the virtual login
	Set the inactive logout timer to 30 minutes
	Set the input method to only ssh

	MLS,SW1-4(config-line)#login local				//binds the virtual consoles to the local login account
	MLS,SW1-4(config-line)#exec-timeout 30				//sets the inactive logout timer to 30 minutes
	MLS,SW1-4(config-line)#transport input ssh			//sets the only input method to ssh

	Admin PC:ssh -l admin 10.0.1.1					//these are all of the SVI interfaces you will ssh into. The terminal will ask for the password
	Admin PC:ssh -l admin 10.0.1.240
	Admin PC:ssh -l admin 10.0.1.241
	Admin PC:ssh -l admin 10.0.1.242
	Admin PC:ssh -l admin 10.0.1.243

	note: the "-l" flag is a lower-case L, not a one.


All done! This will serve as the framework for a lot of labs that have to deal with remote logins and even serve as the logins for console access.

Don't forget the "copy run start" command to save your configurations.



